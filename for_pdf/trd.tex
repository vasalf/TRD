\documentclass{article}

% Tools
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{lastpage}
\usepackage{multicol}

% Page geometry
\usepackage{geometry}
\geometry{a4paper, margin=1cm, top=2cm}

% Fonts
\usepackage{fontspec}
\setmainfont{CMU Serif}
\setsansfont{CMU Sans Serif}
\setmonofont{CMU Typewriter Text}

% Languages
\usepackage{polyglossia}
\setdefaultlanguage[spelling=modern]{russian}
\setotherlanguage[variant=british]{english}

% Headers
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\lhead{SPb HSE 1: Lemon Tree (Alferov, Makhnev, Surkov)}
\rhead{Page \thepage~of \pageref{LastPage}}

% Code
\usepackage{minted}

\begin{document}
%% MATH

\section*{Prime numbers}

\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
$10^{1}$ & $+1$ & $+3$ & $+7$ & $+9$ & $+13$ & $+19$ & $+21$ & $+27$ & $-3$ & $-5$ & $-7$ & $-8$ \\
\hline
$10^{2}$ & $+1$ & $+3$ & $+7$ & $+9$ & $+13$ & $+27$ & $+31$ & $+37$ & $-3$ & $-11$ & $-17$ & $-21$ \\
\hline
$10^{3}$ & $+9$ & $+13$ & $+19$ & $+21$ & $+31$ & $+33$ & $+39$ & $+49$ & $-3$ & $-9$ & $-17$ & $-23$ \\
\hline
$10^{4}$ & $+7$ & $+9$ & $+37$ & $+39$ & $+61$ & $+67$ & $+69$ & $+79$ & $-27$ & $-33$ & $-51$ & $-59$ \\
\hline
$10^{5}$ & $+3$ & $+19$ & $+43$ & $+49$ & $+57$ & $+69$ & $+103$ & $+109$ & $-9$ & $-11$ & $-29$ & $-39$ \\
\hline
$10^{6}$ & $+3$ & $+33$ & $+37$ & $+39$ & $+81$ & $+99$ & $+117$ & $+121$ & $-17$ & $-21$ & $-39$ & $-41$ \\
\hline
$10^{7}$ & $+19$ & $+79$ & $+103$ & $+121$ & $+139$ & $+141$ & $+169$ & $+189$ & $-9$ & $-27$ & $-29$ & $-57$ \\
\hline
$10^{8}$ & $+7$ & $+37$ & $+39$ & $+49$ & $+73$ & $+81$ & $+123$ & $+127$ & $-11$ & $-29$ & $-41$ & $-59$ \\
\hline
$10^{9}$ & $+7$ & $+9$ & $+21$ & $+33$ & $+87$ & $+93$ & $+97$ & $+103$ & $-63$ & $-71$ & $-107$ & $-117$ \\
\hline
$10^{10}$ & $+19$ & $+33$ & $+61$ & $+69$ & $+97$ & $+103$ & $+121$ & $+141$ & $-33$ & $-57$ & $-71$ & $-119$ \\
\hline
$10^{11}$ & $+3$ & $+19$ & $+57$ & $+63$ & $+69$ & $+73$ & $+91$ & $+103$ & $-23$ & $-53$ & $-57$ & $-93$ \\
\hline
$10^{12}$ & $+39$ & $+61$ & $+63$ & $+91$ & $+121$ & $+163$ & $+169$ & $+177$ & $-11$ & $-39$ & $-41$ & $-63$ \\
\hline
$10^{13}$ & $+37$ & $+51$ & $+99$ & $+129$ & $+183$ & $+259$ & $+267$ & $+273$ & $-29$ & $-137$ & $-201$ & $-237$ \\
\hline
$10^{14}$ & $+31$ & $+67$ & $+97$ & $+99$ & $+133$ & $+139$ & $+169$ & $+183$ & $-27$ & $-29$ & $-41$ & $-69$ \\
\hline
$10^{15}$ & $+37$ & $+91$ & $+159$ & $+187$ & $+223$ & $+241$ & $+249$ & $+259$ & $-11$ & $-53$ & $-117$ & $-123$ \\
\hline
$10^{16}$ & $+61$ & $+69$ & $+79$ & $+99$ & $+453$ & $+481$ & $+597$ & $+613$ & $-63$ & $-83$ & $-113$ & $-149$ \\
\hline
$10^{17}$ & $+3$ & $+13$ & $+19$ & $+21$ & $+49$ & $+81$ & $+99$ & $+141$ & $-3$ & $-23$ & $-39$ & $-57$ \\
\hline
$10^{18}$ & $+3$ & $+9$ & $+31$ & $+79$ & $+177$ & $+183$ & $+201$ & $+283$ & $-11$ & $-33$ & $-123$ & $-137$ \\
\hline
\end{tabular}

\section*{Primitive Roots}

\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
\hline
\hline
$mod$& $12\cdot 2^{10}+1$& $13\cdot 2^{10}+1$& $15\cdot 2^{10}+1$& $57\cdot 2^{10}+1$& $58\cdot 2^{10}+1$& $60\cdot 2^{10}+1$& $148\cdot 2^{10}+1$\\
\hline

$root$& $49$& $7$& $84$& $29$& $9$& $21$& $38$\\
\hline


$mod$& $6\cdot 2^{11}+1$& $9\cdot 2^{11}+1$& $20\cdot 2^{11}+1$& $56\cdot 2^{11}+1$& $65\cdot 2^{11}+1$& $140\cdot 2^{11}+1$& $150\cdot 2^{11}+1$\\
\hline

$root$& $7$& $19$& $32$& $16$& $39$& $106$& $91$\\
\hline


$mod$& $3\cdot 2^{12}+1$& $10\cdot 2^{12}+1$& $15\cdot 2^{12}+1$& $66\cdot 2^{12}+1$& $70\cdot 2^{12}+1$& $75\cdot 2^{12}+1$& $127\cdot 2^{12}+1$\\
\hline

$root$& $41$& $28$& $19$& $114$& $19$& $41$& $71$\\
\hline

$mod$& $136\cdot 2^{12}+1$& $141\cdot 2^{12}+1$& $5\cdot 2^{13}+1$& $8\cdot 2^{13}+1$& $14\cdot 2^{13}+1$& $51\cdot 2^{13}+1$& $78\cdot 2^{13}+1$\\
\hline

$root$& $66$& $114$& $12$& $13$& $2$& $67$& $87$\\
\hline


$mod$& $90\cdot 2^{13}+1$& $113\cdot 2^{13}+1$& $4\cdot 2^{14}+1$& $7\cdot 2^{14}+1$& $9\cdot 2^{14}+1$& $63\cdot 2^{14}+1$& $69\cdot 2^{14}+1$\\
\hline

$root$& $96$& $63$& $15$& $15$& $22$& $94$& $86$\\
\hline


$mod$& $73\cdot 2^{14}+1$& $139\cdot 2^{14}+1$& $2\cdot 2^{15}+1$& $5\cdot 2^{15}+1$& $17\cdot 2^{15}+1$& $81\cdot 2^{15}+1$& $110\cdot 2^{15}+1$\\
\hline

$root$& $31$& $20$& $9$& $7$& $19$& $89$& $117$\\
\hline


$mod$& $114\cdot 2^{15}+1$& $135\cdot 2^{15}+1$& $1\cdot 2^{16}+1$& $12\cdot 2^{16}+1$& $18\cdot 2^{16}+1$& $55\cdot 2^{16}+1$& $88\cdot 2^{16}+1$\\
\hline

$root$& $27$& $126$& $3$& $3$& $14$& $30$& $10$\\
\hline


$mod$& $102\cdot 2^{16}+1$& $112\cdot 2^{16}+1$& $117\cdot 2^{16}+1$& $6\cdot 2^{17}+1$& $9\cdot 2^{17}+1$& $21\cdot 2^{17}+1$& $51\cdot 2^{17}+1$\\
\hline

$root$& $51$& $83$& $15$& $8$& $74$& $83$& $43$\\
\hline


$mod$& $53\cdot 2^{17}+1$& $63\cdot 2^{17}+1$& $104\cdot 2^{17}+1$& $108\cdot 2^{17}+1$& $123\cdot 2^{17}+1$& $3\cdot 2^{18}+1$& $22\cdot 2^{18}+1$\\
\hline

$root$& $47$& $10$& $13$& $54$& $26$& $5$& $74$\\
\hline

% \end{tabular}
% \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
% \hline

$mod$& $28\cdot 2^{18}+1$& $52\cdot 2^{18}+1$& $54\cdot 2^{18}+1$& $63\cdot 2^{18}+1$& $108\cdot 2^{18}+1$& $127\cdot 2^{18}+1$& $147\cdot 2^{18}+1$\\
\hline

$root$& $79$& $4$& $25$& $70$& $108$& $99$& $34$\\
\hline


$mod$& $11\cdot 2^{19}+1$& $14\cdot 2^{19}+1$& $26\cdot 2^{19}+1$& $54\cdot 2^{19}+1$& $57\cdot 2^{19}+1$& $71\cdot 2^{19}+1$& $134\cdot 2^{19}+1$\\
\hline

$root$& $12$& $25$& $2$& $106$& $20$& $86$& $49$\\
\hline


$mod$& $7\cdot 2^{20}+1$& $13\cdot 2^{20}+1$& $22\cdot 2^{20}+1$& $66\cdot 2^{20}+1$& $67\cdot 2^{20}+1$& $106\cdot 2^{20}+1$& $115\cdot 2^{20}+1$\\
\hline

$root$& $5$& $3$& $50$& $54$& $7$& $85$& $138$\\
\hline


$mod$& $148\cdot 2^{20}+1$& $11\cdot 2^{21}+1$& $33\cdot 2^{21}+1$& $39\cdot 2^{21}+1$& $53\cdot 2^{21}+1$& $54\cdot 2^{21}+1$& $63\cdot 2^{21}+1$\\
\hline

$root$& $81$& $38$& $45$& $94$& $54$& $134$& $46$\\
\hline


$mod$& $110\cdot 2^{21}+1$& $119\cdot 2^{21}+1$& $123\cdot 2^{21}+1$& $25\cdot 2^{22}+1$& $27\cdot 2^{22}+1$& $33\cdot 2^{22}+1$& $55\cdot 2^{22}+1$\\
\hline

$root$& $68$& $135$& $95$& $21$& $66$& $30$& $63$\\
\hline


$mod$& $90\cdot 2^{22}+1$& $99\cdot 2^{22}+1$& $20\cdot 2^{23}+1$& $56\cdot 2^{23}+1$& $77\cdot 2^{23}+1$& $107\cdot 2^{23}+1$& $119\cdot 2^{23}+1$\\
\hline

$root$& $139$& $65$& $4$& $53$& $19$& $45$& $31$\\
\hline


$mod$& $132\cdot 2^{23}+1$& $10\cdot 2^{24}+1$& $28\cdot 2^{24}+1$& $66\cdot 2^{24}+1$& $73\cdot 2^{24}+1$& $108\cdot 2^{24}+1$& $120\cdot 2^{24}+1$\\
\hline

$root$& $64$& $2$& $40$& $8$& $149$& $126$& $21$\\
\hline


$mod$& $148\cdot 2^{24}+1$\\
\hline

$root$& $25$\\
\hline
\end{tabular}


\newpage
\section*{Misc}

{\bf Gomory-Hu tree (Gusfield’s algorithm)}: label nodes from $0$ to ($|V| - 1$) and 
set $p_i=0 \forall i > 0$. $\forall\,i > 0$: find min-cut $(S, T)$ 
between $i$ and $p_i$, where $i \in S, p_i \in T$; 
for each node $j$, s.t. $i < j, j \in S, p_j=p_i$ set $p_j = i$

\fbox{$d_i = v_i - \sum\limits_{j<i}\frac{\langle v_i, d_j\rangle}{\langle d_j, d_j\rangle}d_j$}
\fbox{$\sum\limits_{k=1}^{n}\mu(k)\lfloor\frac n k\rfloor = 1$}
\fbox{$g(n)=\sum\limits_{d|n}f(d) \Leftrightarrow f(n) = \sum\limits_{d|n}\mu(d)g(n/d)$}

\fbox{$\mu^*_A(a,b)=
\begin{cases}
1, & a=b \\
-\sum\limits_{a\preccurlyeq z \prec b}\mu_A^*(a, z), & a \prec b \\
0, & b \prec a
\end{cases}$}
\fbox{$\sum\limits_{d|n}\varphi(d) = n$}
\fbox{$\varphi(n)=\sum\limits_{d|n}d\cdot\mu(\frac n d)$}

\fbox{$F(N) = \sum\limits_{n=1}^N\varphi(n) \Rightarrow F(N) = \frac{N(N+1)}2 - \sum\limits_{k=2}^{N}F(\lfloor\frac N k\rfloor)$}

\fbox{$Gx = \{y \in X| \exists a \in G\colon a\star x = y\}$}
\fbox{$G_x = \{a \in G\colon a\star x = x\}$}
\fbox{$|G|=|Gx|\cdot|G_x|$}
\fbox{$X^a=\{x\in X\colon a\star x = x\}$}

\fbox{$|X\textfractionsolidus G| = \frac 1 {|G|}\sum\limits_{a\in G}|X^a|$}
\fbox{$\prod\limits_{k=1}^{\infty}(1-x^k)=\sum\limits_{q=-\infty}^{+\infty}(-1)^qx^{\frac{3q^2+q}{2}}$}

\fbox{$\prod\limits_{k=1}^{\infty}\frac{1}{1-x^k}=\sum\limits_{n=0}^{+\infty}p(n)x^n\Rightarrow p(0)=1, p(n)=\sum\limits_{q=1}^{+\infty}(-1)^{q+1}\left[p\left(n-\frac{3q^2-q}{2}\right)+p\left(n-\frac{3q^2+q}{2}\right)\right]$}

\fbox{$M_1=(S,I_1)\cap M_2=(S,I_2). J. y\rightarrow z (J - y + z \in I_1). y\leftarrow z (J - y + z \in I_2)$}

\fbox{$X_2=\{z\in S/J\colon J+z\in I_1\}.X_2=\{z\in S/J\colon J+z\in I_2\}.$ Находим {\bf кратчайший} путь из $X_1$ в $X_2$. Ксорим.}

\fbox{$x = \frac{B_1C_2 - B_2C_1}{A_1B_2 - A_2B_1}$, $y = \frac{A_2C_1 - A_1C_2}{A_1B_2 - A_2B_1}$}

\fbox{Теорема Пика. $S = I + \frac B 2 - 1$, где $S$ -- площадь, $B$ -- \# на сторонах, $I$ -- \# строго внутри}

\fbox{$s(0,0)=c(0,0)=1.s(n,k)=s(n-1,k-1)-(n-1)s(n-1,k).c(n,k)=c(n-1,k-1)+(n-1)c(n-1,k).$}

\fbox{$\sum\limits_{k=0}^{n}c(n,k)x^k=x(x+1)(x+2)\cdot\ldots\cdot(x+n-1).\sum\limits_{k=0}^{n}s(n,k)x^k=x(x-1)(x-2)\cdot\ldots\cdot(x-n+1)$}

\fbox{$c(n, k) = (-1)^{n-k}s(n,k)$}
\fbox{$\sum\limits_{n=0}^{\infty}\sum\limits_{k=0}^{n}\frac{c(n,k)}{n!}x^ny^k = \exp\left(-y\log(1-x)\right)$}
\fbox{$\sum\limits_{n=0}^{\infty}\sum\limits_{k=0}^{n}\frac{s(n,k)}{n!}x^ny^k = \exp\left(y\log(1+x)\right)$}

%% ALGORIGHMS
\begin{multicols}{2}
% String Algorithms
\section*{Suffix Tree}
\inputminted[frame=single,breaklines]{cpp}{../suffix-tree.cpp}

\section*{Suffix Array}
\inputminted[frame=single,breaklines]{cpp}{../suffix-array.cpp}

\section*{Suffix Automation}
\inputminted[frame=single,breaklines]{cpp}{../suffix-automation.cpp}

\section*{LCP}
\inputminted[frame=single,breaklines]{cpp}{../Kasai-Li.cpp}

\section*{Manacker}
\inputminted[frame=single,breaklines]{cpp}{../manacker.cpp}

\section*{Prefix Function}
\inputminted[frame=single,breaklines]{cpp}{../P-function.cpp}

\section*{Z-Function}
\inputminted[frame=single,breaklines]{cpp}{../Z-function.cpp}

\section*{Tandem (Lorentz)}
\inputminted[frame=single,breaklines]{cpp}{../main-lorentz.cpp}

\section*{Aho-Corasick}
\inputminted[frame=single,breaklines]{cpp}{../aho-corasick.cpp}

\section*{Eertree}
\inputminted[frame=single,breaklines]{cpp}{../eer-tree.cpp}

% Graph Algorithms
\section*{Components of Vertex Duality}
\inputminted[frame=single,breaklines]{cpp}{../componentsOfVertexDuality.cpp}

\section*{Hungarian Algorihtm}
\inputminted[frame=single,breaklines]{cpp}{../hungarian.cpp}

\section*{General Matching}
\inputminted[frame=single,breaklines]{cpp}{../general_matching.cpp}

\section*{Hopcroft-Karp}
\inputminted[frame=single,breaklines]{cpp}{../hopcroft-karp.cpp}

\section*{Dinic}
\inputminted[frame=single,breaklines]{cpp}{../Dinic.cpp}

\section*{MCMF}
\inputminted[frame=single,breaklines]{cpp}{../MCMF.cpp}

\section*{Algorithm of Two Chinese}
\inputminted[frame=single,breaklines]{cpp}{../2-chinese.cpp}

\section*{Dominator Tree}
\inputminted[frame=single,breaklines]{cpp}{../dominator_tree.cpp}

% Numbers
\section*{Factorization}
\inputminted[frame=single,breaklines]{cpp}{../pollard-rho.cpp}

\section*{Square Root in $\mathbb{Z}_p$ in $O(\log{p})$}
\inputminted[frame=single,breaklines]{cpp}{../sqrtmod.cpp}

\section*{Euclid (??)}
\inputminted[frame=single,breaklines]{cpp}{../euclid.cpp}

\section*{Primes on Segment}
\inputminted[frame=single,breaklines]{cpp}{../sum_powers_primes_on_segment_short.cpp}

\section*{Pro Euclid}
\inputminted[frame=single,breaklines]{cpp}{../pro-euclid.cpp}

% FFT and friends
\section*{FFT with prime mod}
\inputminted[frame=single,breaklines]{cpp}{../fft_with_prime_mod.cpp}

\section*{Polynomial Division}
\inputminted[frame=single,breaklines]{cpp}{../polynom_division.cpp}

\section*{FFT}
\inputminted[frame=single,breaklines]{cpp}{../fft.cpp}

\section*{Extrapolation}
\inputminted[frame=single,breaklines]{cpp}{../extrapolation.cpp}

\section*{Xor FWHT}
\inputminted[frame=single,breaklines]{cpp}{../fwht.cpp}

% Misc
\section*{CHT}
\inputminted[frame=single,breaklines]{cpp}{../convex-hull-trick.cpp}

\section*{Euler Tour Trees}
\inputminted[frame=single,breaklines]{cpp}{../euler-tour-trees.cpp}

\section*{Simplex}
\inputminted[frame=single,breaklines]{cpp}{../simplex.cpp}

\section*{Fast Allocator}
\inputminted[frame=single,breaklines]{cpp}{../fast_allocation.cpp}

% Geometry
\section*{Angle Comparator}
\inputminted[frame=single,breaklines]{cpp}{../angle-comparator.cpp}

\section*{Common Tangents}
\inputminted[frame=single,breaklines]{cpp}{../get_common_tangents.cpp}

\section*{Find Tangents in polygon $O(\log n)$}
\inputminted[frame=single,breaklines]{cpp}{../find_tangents_on_convex_polygon_log.cpp}

\section*{Minkowsky Polygon Sum}
\inputminted[frame=single,breaklines]{cpp}{../minkowski-polygons-sum.cpp}

\section*{Halfplanes Intersection $O(n \log n)$}
\inputminted[frame=single,breaklines]{cpp}{../halfplanes_intersection_nlog_short.cpp}

\section*{Fenwick Descent}
\inputminted[frame=single,breaklines]{cpp}{../fenwick_descent.cpp}

\section*{STL Tree}
\inputminted[frame=single,breaklines]{cpp}{../stl_tree_import.cpp}

\section*{Convex Hull 3d $O(n^2)$}
\inputminted[frame=single,breaklines]{cpp}{../convex-hull-3d-crop.cpp}


\end{multicols}
\end{document}
